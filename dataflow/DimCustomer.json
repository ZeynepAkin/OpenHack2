{
	"name": "DimCustomer",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "TargetCloudSalesCustomers",
						"type": "DatasetReference"
					},
					"name": "SalesSouthridgeCustomer"
				},
				{
					"dataset": {
						"referenceName": "TargetCloudSalesAdresses",
						"type": "DatasetReference"
					},
					"name": "SalesSouthridgeAdresses"
				},
				{
					"dataset": {
						"referenceName": "TargetCloudStreamingCustomers",
						"type": "DatasetReference"
					},
					"name": "StreamingSouthridgeCustomer"
				},
				{
					"dataset": {
						"referenceName": "TargetCloudStreamingAddresses",
						"type": "DatasetReference"
					},
					"name": "StreamingSouthridgeAdresses"
				},
				{
					"dataset": {
						"referenceName": "TargetFourthCoffeeCustomers",
						"type": "DatasetReference"
					},
					"name": "FourthCoffeeCustomer"
				},
				{
					"dataset": {
						"referenceName": "VanArsdelCustomer",
						"type": "DatasetReference"
					},
					"name": "VanArselCustomer"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "DimCustomer",
						"type": "DatasetReference"
					},
					"name": "TargetDimCustomer"
				}
			],
			"transformations": [
				{
					"name": "SalesCustomerAdressJoin"
				},
				{
					"name": "StreamingCustomerAdressesJoin"
				},
				{
					"name": "Union1"
				},
				{
					"name": "SelectSalesColumn"
				},
				{
					"name": "SelectStreamingColumn"
				},
				{
					"name": "Union"
				},
				{
					"name": "Union2"
				},
				{
					"name": "SSID4"
				},
				{
					"name": "SSID"
				},
				{
					"name": "SSID2"
				},
				{
					"name": "SSID3"
				},
				{
					"name": "DerivedColumn1"
				},
				{
					"name": "DerivedColumnToDate"
				},
				{
					"name": "DerivedColumn2ToDate"
				},
				{
					"name": "DerivedColumn3ToDate"
				}
			],
			"script": "\n\nsource(output(\n\t\tCustomerID as string,\n\t\tLastName as string,\n\t\tFirstName as string,\n\t\tPhoneNumber as string,\n\t\tCreatedDate as string,\n\t\tUpdatedDate as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: true,\n\tlimit: 100) ~> SalesSouthridgeCustomer\nsource(output(\n\t\tAddressID as string,\n\t\tCustomerID as string,\n\t\tAddressLine1 as string,\n\t\tAddressLine2 as string,\n\t\tCity as string,\n\t\tState as string,\n\t\tZipCode as string,\n\t\tCreatedDate as string,\n\t\tUpdatedDate as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tlimit: 100) ~> SalesSouthridgeAdresses\nsource(output(\n\t\tCustomerID as string,\n\t\tLastName as string,\n\t\tFirstName as string,\n\t\tPhoneNumber as string,\n\t\tCreatedDate as string,\n\t\tUpdatedDate as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tlimit: 100) ~> StreamingSouthridgeCustomer\nsource(output(\n\t\tAddressID as string,\n\t\tCustomerID as string,\n\t\tAddressLine1 as string,\n\t\tAddressLine2 as string,\n\t\tCity as string,\n\t\tState as string,\n\t\tZipCode as string,\n\t\tCreatedDate as string,\n\t\tUpdatedDate as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tlimit: 100) ~> StreamingSouthridgeAdresses\nsource(output(\n\t\tCustomerID as string,\n\t\tLastName as string,\n\t\tFirstName as string,\n\t\tAddressLine1 as string,\n\t\tAddressLine2 as string,\n\t\tCity as string,\n\t\tState as string,\n\t\tZipCode as string,\n\t\tPhoneNumber as string,\n\t\tCreatedDate as string,\n\t\tUpdatedDate as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tlimit: 100) ~> FourthCoffeeCustomer\nsource(output(\n\t\tCustomerID as string,\n\t\tLastName as string,\n\t\tFirstName as string,\n\t\tAddressLine1 as string,\n\t\tAddressLine2 as string,\n\t\tCity as string,\n\t\tState as string,\n\t\tZipCode as string,\n\t\tPhoneNumber as string,\n\t\tCreatedDate as string,\n\t\tUpdatedDate as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tlimit: 100) ~> VanArselCustomer\nSalesSouthridgeCustomer, SalesSouthridgeAdresses join(SalesSouthridgeCustomer@CustomerID == SalesSouthridgeAdresses@CustomerID,\n\tjoinType:'left',\n\tbroadcast: 'none')~> SalesCustomerAdressJoin\nDerivedColumn3ToDate, StreamingSouthridgeAdresses join(StreamingSouthridgeCustomer@CustomerID == StreamingSouthridgeAdresses@CustomerID,\n\tjoinType:'left',\n\tbroadcast: 'none')~> StreamingCustomerAdressesJoin\nSSID2, SSID3 union(byName: true)~> Union1\nSalesCustomerAdressJoin select(mapColumn(\n\t\tCustomerID = SalesSouthridgeCustomer@CustomerID,\n\t\tLastName,\n\t\tFirstName,\n\t\tPhoneNumber,\n\t\tCreatedDate = SalesSouthridgeCustomer@CreatedDate,\n\t\tUpdatedDate = SalesSouthridgeCustomer@UpdatedDate,\n\t\tAddressID,\n\t\tAddressLine1,\n\t\tAddressLine2,\n\t\tCity,\n\t\tState,\n\t\tZipCode\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> SelectSalesColumn\nSSID select(mapColumn(\n\t\tCustomerID = StreamingSouthridgeCustomer@CustomerID,\n\t\tLastName,\n\t\tFirstName,\n\t\tPhoneNumber,\n\t\tCreatedDate = DerivedColumn3ToDate@CreatedDate,\n\t\tUpdatedDate = DerivedColumn3ToDate@CreatedDate,\n\t\tAddressID,\n\t\tAddressLine1,\n\t\tAddressLine2,\n\t\tCity,\n\t\tState,\n\t\tZipCode,\n\t\tSourceSystemID\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> SelectStreamingColumn\nSSID4, SelectStreamingColumn union(byName: true)~> Union\nUnion, Union1 union(byName: true)~> Union2\nSelectSalesColumn derive(SourceSystemID = 1,\n\t\tCreatedDate = toDate(CreatedDate,'yyyy-MM-dd'),\n\t\tUpdatedDate = toDate(UpdatedDate,'yyyy-MM-dd')) ~> SSID4\nStreamingCustomerAdressesJoin derive(SourceSystemID = 1) ~> SSID\nDerivedColumnToDate derive(SourceSystemID = 2) ~> SSID2\nDerivedColumn2ToDate derive(SourceSystemID = 3) ~> SSID3\nUnion2 derive(GlobalCustomerID = uuid()) ~> DerivedColumn1\nFourthCoffeeCustomer derive(CreatedDate = toDate(CreatedDate,'yyyy-MM-dd'),\n\t\tUpdatedDate = toDate(UpdatedDate,'yyyy-MM-dd')) ~> DerivedColumnToDate\nVanArselCustomer derive(CreatedDate = toDate(CreatedDate,'yyyy-MM-dd'),\n\t\tUpdatedDate = toDate(UpdatedDate,'yyyy-MM-dd')) ~> DerivedColumn2ToDate\nStreamingSouthridgeCustomer derive(CreatedDate = toDate(CreatedDate,'yyyy-MM-dd'),\n\t\tUpdatedDate = toDate(UpdatedDate,'yyyy-MM-dd')) ~> DerivedColumn3ToDate\nDerivedColumn1 sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tpartitionFileNames:['DimCustomer.csv'],\n\tpartitionBy('hash', 1)) ~> TargetDimCustomer"
		}
	}
}