{
	"name": "SalesSTEP1",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "Sales",
						"type": "DatasetReference"
					},
					"name": "Sales"
				},
				{
					"dataset": {
						"referenceName": "Cstmr",
						"type": "DatasetReference"
					},
					"name": "Customer"
				},
				{
					"dataset": {
						"referenceName": "AzureSynapseAnalyticsTable2",
						"type": "DatasetReference"
					},
					"name": "DimCustomer"
				},
				{
					"dataset": {
						"referenceName": "AzureSynapseAnalyticsTable3",
						"type": "DatasetReference"
					},
					"name": "Date"
				},
				{
					"dataset": {
						"referenceName": "AzureSynapseAnalyticsTable3",
						"type": "DatasetReference"
					},
					"name": "OrderDate"
				},
				{
					"dataset": {
						"referenceName": "AzureSynapseAnalyticsTable4",
						"type": "DatasetReference"
					},
					"name": "Movie"
				}
			],
			"sinks": [],
			"transformations": [
				{
					"name": "Filter1"
				},
				{
					"name": "Join1"
				},
				{
					"name": "Select1"
				},
				{
					"name": "DC"
				},
				{
					"name": "LUCSTMR"
				},
				{
					"name": "Select2"
				},
				{
					"name": "Lookup1"
				},
				{
					"name": "Select3"
				},
				{
					"name": "Lookup2"
				},
				{
					"name": "Select4"
				},
				{
					"name": "Lookup3"
				},
				{
					"name": "Select5"
				}
			],
			"script": "\n\nsource(output(\n\t\tOrderID as string,\n\t\tCustomerID as string,\n\t\tOrderDate as string,\n\t\tShipDate as string,\n\t\tTotalCost as string,\n\t\tCreatedDate as string,\n\t\tOrderDetailID as string,\n\t\tMovieID as string,\n\t\tQuantity as string,\n\t\tUnitCost as string,\n\t\tLineNumber as string,\n\t\tUpdatedDate as string,\n\t\tSourceSystemID as string,\n\t\tGlobelOrderID as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tlimit: 100) ~> Sales\nsource(output(\n\t\tCustomerID as string,\n\t\tLastName as string,\n\t\tFirstName as string,\n\t\tPhoneNumber as string,\n\t\tCreatedDate as string,\n\t\tUpdatedDate as string,\n\t\tAddressID as string,\n\t\tAddressLine1 as string,\n\t\tAddressLine2 as string,\n\t\tCity as string,\n\t\tState as string,\n\t\tZipCode as string,\n\t\tSourceSystemID as string,\n\t\tGlobalCustomerID as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false) ~> Customer\nsource(output(\n\t\tCustomerSK as integer,\n\t\tCustomerID as string,\n\t\tLastName as string,\n\t\tFirstName as string,\n\t\tAddressLine1 as string,\n\t\tAddressLine2 as string,\n\t\tCity as string,\n\t\tState as string,\n\t\tZipCode as string,\n\t\tPhoneNumber as string,\n\t\tRecordStartDate as date,\n\t\tRecordEndDate as date,\n\t\tActiveFlag as integer\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tformat: 'table',\n\tstaged: false) ~> DimCustomer\nsource(output(\n\t\tDateSK as integer,\n\t\tDateValue as date,\n\t\tDateYear as integer,\n\t\tDateMonth as integer,\n\t\tDateDay as integer,\n\t\tDateDayOfWeek as integer,\n\t\tDateDayOfYear as integer,\n\t\tDateWeekOfYear as integer\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tlimit: 100,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tformat: 'table',\n\tstaged: false) ~> Date\nsource(output(\n\t\tDateSK as integer,\n\t\tDateValue as date,\n\t\tDateYear as integer,\n\t\tDateMonth as integer,\n\t\tDateDay as integer,\n\t\tDateDayOfWeek as integer,\n\t\tDateDayOfYear as integer,\n\t\tDateWeekOfYear as integer\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tformat: 'table',\n\tstaged: false) ~> OrderDate\nsource(output(\n\t\tMovieSK as integer,\n\t\tMovieID as string,\n\t\tMovieTitle as string,\n\t\tMovieCategorySK as integer,\n\t\tMovieRatingSK as integer,\n\t\tMovieRunTimeMin as integer\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tformat: 'table',\n\tstaged: false) ~> Movie\nCustomer filter(SourceSystemID=='1') ~> Filter1\nSales, Filter1 join(Sales@CustomerID == Customer@CustomerID,\n\tjoinType:'inner',\n\tbroadcast: 'none')~> Join1\nJoin1 select(mapColumn(\n\t\tOrderID,\n\t\tCustomerID = Sales@CustomerID,\n\t\tOrderDate,\n\t\tShipDate,\n\t\tTotalCost,\n\t\tCreatedDate = Sales@CreatedDate,\n\t\tOrderDetailID,\n\t\tMovieID,\n\t\tQuantity,\n\t\tUnitCost,\n\t\tLineNumber,\n\t\tUpdatedDate = Sales@UpdatedDate,\n\t\tSourceSystemID = Sales@SourceSystemID,\n\t\tGlobelOrderID,\n\t\tSourceSystemID = Customer@SourceSystemID,\n\t\tGlobalCustomerID\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Select1\nSelect1 derive(DaysToShip = minus(toDate(ShipDate,'YYYY-mm-dd'), toDate(OrderDate,'YYYY-mm-dd')),\n\t\tExtendedCost = toFloat(UnitCost) *toInteger(Quantity),\n\t\tShipDateFormat = toDate(ShipDate,'YYYY-mm-dd'),\n\t\tOrderDateFormat = toDate(OrderDate,'YYYY-mm-dd')) ~> DC\nDC, DimCustomer lookup(GlobalCustomerID == DimCustomer@CustomerID,\n\tbroadcast: 'none')~> LUCSTMR\nLUCSTMR select(mapColumn(\n\t\tOrderID,\n\t\tCustomerID = Select1@CustomerID,\n\t\tOrderDate,\n\t\tShipDate,\n\t\tTotalCost,\n\t\tCreatedDate,\n\t\tOrderDetailID,\n\t\tMovieID,\n\t\tQuantity,\n\t\tUnitCost,\n\t\tLineNumber,\n\t\tUpdatedDate,\n\t\tSourceSystemID,\n\t\tGlobelOrderID,\n\t\tGlobalCustomerID,\n\t\tDaysToShip,\n\t\tExtendedCost,\n\t\tShipDateFormat,\n\t\tOrderDateFormat,\n\t\tCustomerSK\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Select2\nSelect2, Date lookup(ShipDateFormat == DateValue,\n\tbroadcast: 'none')~> Lookup1\nLookup1 select(mapColumn(\n\t\tOrderID,\n\t\tCustomerID,\n\t\tOrderDate,\n\t\tShipDate,\n\t\tTotalCost,\n\t\tCreatedDate,\n\t\tOrderDetailID,\n\t\tMovieID,\n\t\tQuantity,\n\t\tUnitCost,\n\t\tLineNumber,\n\t\tUpdatedDate,\n\t\tSourceSystemID,\n\t\tGlobelOrderID,\n\t\tGlobalCustomerID,\n\t\tDaysToShip,\n\t\tExtendedCost,\n\t\tShipDateFormat,\n\t\tOrderDateFormat,\n\t\tCustomerSK,\n\t\tDateSKShip = DateSK\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Select3\nSelect3, OrderDate lookup(OrderDateFormat == DateValue,\n\tbroadcast: 'none')~> Lookup2\nLookup2 select(mapColumn(\n\t\tOrderID,\n\t\tCustomerID,\n\t\tOrderDate,\n\t\tShipDate,\n\t\tTotalCost,\n\t\tCreatedDate,\n\t\tOrderDetailID,\n\t\tMovieID,\n\t\tQuantity,\n\t\tUnitCost,\n\t\tLineNumber,\n\t\tUpdatedDate,\n\t\tSourceSystemID,\n\t\tGlobelOrderID,\n\t\tGlobalCustomerID,\n\t\tDaysToShip,\n\t\tExtendedCost,\n\t\tShipDateFormat,\n\t\tOrderDateFormat,\n\t\tCustomerSK,\n\t\tDateSKShip,\n\t\tDateSKOrder = DateSK\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Select4\nSelect4, Movie lookup(Select4@MovieID == Movie@MovieID,\n\tbroadcast: 'none')~> Lookup3\nLookup3 select(mapColumn(\n\t\tOrderID,\n\t\tCustomerID,\n\t\tOrderDate,\n\t\tShipDate,\n\t\tTotalCost,\n\t\tCreatedDate,\n\t\tOrderDetailID,\n\t\tMovieID = Select4@MovieID,\n\t\tQuantity,\n\t\tUnitCost,\n\t\tLineNumber,\n\t\tUpdatedDate,\n\t\tSourceSystemID,\n\t\tGlobelOrderID,\n\t\tGlobalCustomerID,\n\t\tDaysToShip,\n\t\tExtendedCost,\n\t\tShipDateFormat,\n\t\tOrderDateFormat,\n\t\tCustomerSK,\n\t\tDateSKShip,\n\t\tDateSKOrder,\n\t\tMovieSK\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Select5"
		}
	}
}